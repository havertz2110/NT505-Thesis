{
  "batch_info": {
    "processed_at": "2025-10-21T08:02:52.120465",
    "note": "L5 tokens exported separately; main results contain L0-L3 only."
  },
  "statistics": {
    "total_files": 2,
    "processed_files": 2,
    "failed_files": 0,
    "total_tokens": 1332
  },
  "vocabulary": {
    "<PAD>": 1,
    "<UNK>": 2,
    "<START>": 3,
    "<END>": 4,
    "#": 5,
    "VAR": 6,
    "\"STRING_LITERAL\"": 7,
    "MACRO_VAR": 8,
    "TYPE_VAR": 9,
    "else": 10,
    "<": 11,
    ".": 12,
    ">": 13,
    "(": 14,
    ",": 15,
    ")": 16,
    "/": 17,
    "socket": 18,
    "-": 19,
    "1": 20,
    "int": 21,
    "NUM_LITERAL": 22,
    "fopen": 23,
    "void": 24,
    "char": 25,
    "*": 26,
    ";": 27,
    "[": 28,
    "]": 29,
    "=": 30,
    "0": 31,
    "struct": 32,
    "do": 33,
    "if": 34,
    "&": 35,
    "!=": 36,
    "break": 37,
    "==": 38,
    "memset": 39,
    "connect": 40,
    "recv": 41,
    "+": 42,
    "||": 43,
    "'": 44,
    "\\": 45,
    "while": 46,
    "NULL": 47,
    "fclose": 48,
    "static": 49,
    "strcat": 50,
    "return": 51
  },
  "vocabulary_size": 51,
  "files": [
    {
      "file_path": "/mnt/d/GitHub/NT505-Thesis/slicing/CWE23_Relative_Path_Traversal__char_connect_socket_fopen_01.cpp",
      "file_name": "CWE23_Relative_Path_Traversal__char_connect_socket_fopen_01.cpp",
      "processed_at": "2025-10-21T08:02:52.107683",
      "token_statistics": {
        "line_entries": 112,
        "token_count": 628
      },
      "tokens_by_line": [
        {
          "line": 17,
          "code": "#include \"std_testcase.h\"",
          "tokens": [
            "#",
            "VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 19,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 20,
          "code": "#define BASEPATH \"c:\\\\temp\\\\\"",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 21,
          "code": "#else",
          "tokens": [
            "#",
            "else"
          ]
        },
        {
          "line": 22,
          "code": "#include <wchar.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 23,
          "code": "#define BASEPATH \"/tmp/\"",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 24,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 26,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 27,
          "code": "#include <winsock2.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 28,
          "code": "#include <windows.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 29,
          "code": "#include <direct.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 30,
          "code": "#pragma comment(lib, \"ws2_32\") ",
          "tokens": [
            "#",
            "VAR",
            "VAR",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")"
          ]
        },
        {
          "line": 31,
          "code": "#define CLOSE_SOCKET closesocket",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "VAR"
          ]
        },
        {
          "line": 32,
          "code": "#else ",
          "tokens": [
            "#",
            "else"
          ]
        },
        {
          "line": 33,
          "code": "#include <sys/types.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 34,
          "code": "#include <sys/socket.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "socket",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 35,
          "code": "#include <netinet/in.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 36,
          "code": "#include <arpa/inet.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 37,
          "code": "#include <unistd.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 38,
          "code": "#define INVALID_SOCKET -1",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "-",
            "1"
          ]
        },
        {
          "line": 39,
          "code": "#define SOCKET_ERROR -1",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "-",
            "1"
          ]
        },
        {
          "line": 40,
          "code": "#define CLOSE_SOCKET close",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "VAR"
          ]
        },
        {
          "line": 41,
          "code": "#define SOCKET int",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "int"
          ]
        },
        {
          "line": 42,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 44,
          "code": "#define TCP_PORT 27015",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "NUM_LITERAL"
          ]
        },
        {
          "line": 45,
          "code": "#define IP_ADDRESS \"127.0.0.1\"",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 47,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 48,
          "code": "#define FOPEN fopen",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "fopen"
          ]
        },
        {
          "line": 49,
          "code": "#else",
          "tokens": [
            "#",
            "else"
          ]
        },
        {
          "line": 50,
          "code": "#define FOPEN fopen",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "fopen"
          ]
        },
        {
          "line": 51,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 53,
          "code": "namespace CWE23_Relative_Path_Traversal__char_connect_socket_fopen_01",
          "tokens": [
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 56,
          "code": "#ifndef OMITBAD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 58,
          "code": "void bad()",
          "tokens": [
            "void",
            "VAR",
            "(",
            ")"
          ]
        },
        {
          "line": 60,
          "code": "    char * data;",
          "tokens": [
            "char",
            "*",
            "VAR",
            ";"
          ]
        },
        {
          "line": 61,
          "code": "    char dataBuffer[FILENAME_MAX] = BASEPATH;",
          "tokens": [
            "char",
            "VAR",
            "[",
            "MACRO_VAR",
            "]",
            "=",
            "TYPE_VAR",
            ";"
          ]
        },
        {
          "line": 62,
          "code": "    data = dataBuffer;",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            ";"
          ]
        },
        {
          "line": 64,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 65,
          "code": "        WSADATA wsaData;",
          "tokens": [
            "TYPE_VAR",
            "VAR",
            ";"
          ]
        },
        {
          "line": 66,
          "code": "        int wsaDataInit = 0;",
          "tokens": [
            "int",
            "VAR",
            "=",
            "0",
            ";"
          ]
        },
        {
          "line": 67,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 68,
          "code": "        int recvResult;",
          "tokens": [
            "int",
            "VAR",
            ";"
          ]
        },
        {
          "line": 69,
          "code": "        struct sockaddr_in service;",
          "tokens": [
            "struct",
            "VAR",
            "VAR",
            ";"
          ]
        },
        {
          "line": 70,
          "code": "        char *replace;",
          "tokens": [
            "char",
            "*",
            "VAR",
            ";"
          ]
        },
        {
          "line": 71,
          "code": "        SOCKET connectSocket = INVALID_SOCKET;",
          "tokens": [
            "TYPE_VAR",
            "VAR",
            "=",
            "MACRO_VAR",
            ";"
          ]
        },
        {
          "line": 72,
          "code": "        size_t dataLen = strlen(data);",
          "tokens": [
            "VAR",
            "VAR",
            "=",
            "VAR",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 73,
          "code": "        do",
          "tokens": [
            "do"
          ]
        },
        {
          "line": 75,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 76,
          "code": "            if (WSAStartup(MAKEWORD(2,2), &wsaData) != NO_ERROR)",
          "tokens": [
            "if",
            "(",
            "TYPE_VAR",
            "(",
            "TYPE_VAR",
            "(",
            "NUM_LITERAL",
            ",",
            "NUM_LITERAL",
            ")",
            ",",
            "&",
            "VAR",
            ")",
            "!=",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 78,
          "code": "                break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 80,
          "code": "            wsaDataInit = 1;",
          "tokens": [
            "VAR",
            "=",
            "1",
            ";"
          ]
        },
        {
          "line": 81,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 83,
          "code": "            connectSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);",
          "tokens": [
            "VAR",
            "=",
            "socket",
            "(",
            "MACRO_VAR",
            ",",
            "MACRO_VAR",
            ",",
            "MACRO_VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 84,
          "code": "            if (connectSocket == INVALID_SOCKET)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "==",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 86,
          "code": "                break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 88,
          "code": "            memset(&service, 0, sizeof(service));",
          "tokens": [
            "memset",
            "(",
            "&",
            "VAR",
            ",",
            "0",
            ",",
            "VAR",
            "(",
            "VAR",
            ")",
            ")",
            ";"
          ]
        },
        {
          "line": 89,
          "code": "            service.sin_family = AF_INET;",
          "tokens": [
            "VAR",
            ".",
            "VAR",
            "=",
            "MACRO_VAR",
            ";"
          ]
        },
        {
          "line": 90,
          "code": "            service.sin_addr.s_addr = inet_addr(IP_ADDRESS);",
          "tokens": [
            "VAR",
            ".",
            "VAR",
            ".",
            "VAR",
            "=",
            "VAR",
            "(",
            "MACRO_VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 91,
          "code": "            service.sin_port = htons(TCP_PORT);",
          "tokens": [
            "VAR",
            ".",
            "VAR",
            "=",
            "VAR",
            "(",
            "MACRO_VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 92,
          "code": "            if (connect(connectSocket, (struct sockaddr*)&service, sizeof(service)) == SOCKET_ERROR)",
          "tokens": [
            "if",
            "(",
            "connect",
            "(",
            "VAR",
            ",",
            "(",
            "struct",
            "VAR",
            "*",
            ")",
            "&",
            "VAR",
            ",",
            "VAR",
            "(",
            "VAR",
            ")",
            ")",
            "==",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 94,
          "code": "                break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 99,
          "code": "            recvResult = recv(connectSocket, (char *)(data + dataLen), sizeof(char) * (FILENAME_MAX - dataLen - 1), 0);",
          "tokens": [
            "VAR",
            "=",
            "recv",
            "(",
            "VAR",
            ",",
            "(",
            "char",
            "*",
            ")",
            "(",
            "VAR",
            "+",
            "VAR",
            ")",
            ",",
            "VAR",
            "(",
            "char",
            ")",
            "*",
            "(",
            "MACRO_VAR",
            "-",
            "VAR",
            "-",
            "1",
            ")",
            ",",
            "0",
            ")",
            ";"
          ]
        },
        {
          "line": 100,
          "code": "            if (recvResult == SOCKET_ERROR || recvResult == 0)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "==",
            "MACRO_VAR",
            "||",
            "VAR",
            "==",
            "0",
            ")"
          ]
        },
        {
          "line": 102,
          "code": "                break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 105,
          "code": "            data[dataLen + recvResult / sizeof(char)] = '\\0';",
          "tokens": [
            "VAR",
            "[",
            "VAR",
            "+",
            "VAR",
            "/",
            "VAR",
            "(",
            "char",
            ")",
            "]",
            "=",
            "'",
            "\\",
            "0",
            "'",
            ";"
          ]
        },
        {
          "line": 107,
          "code": "            replace = strchr(data, '\\r');",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            "(",
            "VAR",
            ",",
            "'",
            "\\",
            "VAR",
            "'",
            ")",
            ";"
          ]
        },
        {
          "line": 108,
          "code": "            if (replace)",
          "tokens": [
            "if",
            "(",
            "VAR",
            ")"
          ]
        },
        {
          "line": 110,
          "code": "                *replace = '\\0';",
          "tokens": [
            "*",
            "VAR",
            "=",
            "'",
            "\\",
            "0",
            "'",
            ";"
          ]
        },
        {
          "line": 112,
          "code": "            replace = strchr(data, '\\n');",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            "(",
            "VAR",
            ",",
            "'",
            "\\",
            "VAR",
            "'",
            ")",
            ";"
          ]
        },
        {
          "line": 113,
          "code": "            if (replace)",
          "tokens": [
            "if",
            "(",
            "VAR",
            ")"
          ]
        },
        {
          "line": 115,
          "code": "                *replace = '\\0';",
          "tokens": [
            "*",
            "VAR",
            "=",
            "'",
            "\\",
            "0",
            "'",
            ";"
          ]
        },
        {
          "line": 118,
          "code": "        while (0);",
          "tokens": [
            "while",
            "(",
            "0",
            ")",
            ";"
          ]
        },
        {
          "line": 119,
          "code": "        if (connectSocket != INVALID_SOCKET)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "!=",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 121,
          "code": "            CLOSE_SOCKET(connectSocket);",
          "tokens": [
            "MACRO_VAR",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 123,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 124,
          "code": "        if (wsaDataInit)",
          "tokens": [
            "if",
            "(",
            "VAR",
            ")"
          ]
        },
        {
          "line": 126,
          "code": "            WSACleanup();",
          "tokens": [
            "TYPE_VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 128,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 131,
          "code": "        FILE *pFile = NULL;",
          "tokens": [
            "TYPE_VAR",
            "*",
            "VAR",
            "=",
            "NULL",
            ";"
          ]
        },
        {
          "line": 133,
          "code": "        pFile = FOPEN(data, \"wb+\");",
          "tokens": [
            "VAR",
            "=",
            "TYPE_VAR",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 134,
          "code": "        if (pFile != NULL)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "!=",
            "NULL",
            ")"
          ]
        },
        {
          "line": 136,
          "code": "            fclose(pFile);",
          "tokens": [
            "fclose",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 141,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 143,
          "code": "#ifndef OMITGOOD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 146,
          "code": "static void goodG2B()",
          "tokens": [
            "static",
            "void",
            "VAR",
            "(",
            ")"
          ]
        },
        {
          "line": 148,
          "code": "    char * data;",
          "tokens": [
            "char",
            "*",
            "VAR",
            ";"
          ]
        },
        {
          "line": 149,
          "code": "    char dataBuffer[FILENAME_MAX] = BASEPATH;",
          "tokens": [
            "char",
            "VAR",
            "[",
            "MACRO_VAR",
            "]",
            "=",
            "TYPE_VAR",
            ";"
          ]
        },
        {
          "line": 150,
          "code": "    data = dataBuffer;",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            ";"
          ]
        },
        {
          "line": 152,
          "code": "    strcat(data, \"file.txt\");",
          "tokens": [
            "strcat",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 154,
          "code": "        FILE *pFile = NULL;",
          "tokens": [
            "TYPE_VAR",
            "*",
            "VAR",
            "=",
            "NULL",
            ";"
          ]
        },
        {
          "line": 156,
          "code": "        pFile = FOPEN(data, \"wb+\");",
          "tokens": [
            "VAR",
            "=",
            "TYPE_VAR",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 157,
          "code": "        if (pFile != NULL)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "!=",
            "NULL",
            ")"
          ]
        },
        {
          "line": 159,
          "code": "            fclose(pFile);",
          "tokens": [
            "fclose",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 164,
          "code": "void good()",
          "tokens": [
            "void",
            "VAR",
            "(",
            ")"
          ]
        },
        {
          "line": 166,
          "code": "    goodG2B();",
          "tokens": [
            "VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 169,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 178,
          "code": "#ifdef INCLUDEMAIN",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 180,
          "code": "using namespace CWE23_Relative_Path_Traversal__char_connect_socket_fopen_01; ",
          "tokens": [
            "VAR",
            "VAR",
            "TYPE_VAR",
            ";"
          ]
        },
        {
          "line": 182,
          "code": "int main(int argc, char * argv[])",
          "tokens": [
            "int",
            "VAR",
            "(",
            "int",
            "VAR",
            ",",
            "char",
            "*",
            "VAR",
            "[",
            "]",
            ")"
          ]
        },
        {
          "line": 185,
          "code": "    srand( (unsigned)time(NULL) );",
          "tokens": [
            "VAR",
            "(",
            "(",
            "VAR",
            ")",
            "VAR",
            "(",
            "NULL",
            ")",
            ")",
            ";"
          ]
        },
        {
          "line": 186,
          "code": "#ifndef OMITGOOD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 187,
          "code": "    printLine(\"Calling good()...\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 188,
          "code": "    good();",
          "tokens": [
            "VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 189,
          "code": "    printLine(\"Finished good()\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 190,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 191,
          "code": "#ifndef OMITBAD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 192,
          "code": "    printLine(\"Calling bad()...\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 193,
          "code": "    bad();",
          "tokens": [
            "VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 194,
          "code": "    printLine(\"Finished bad()\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 195,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 196,
          "code": "    return 0;",
          "tokens": [
            "return",
            "0",
            ";"
          ]
        },
        {
          "line": 199,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        }
      ]
    },
    {
      "file_path": "/mnt/d/GitHub/NT505-Thesis/slicing/CWE23_Relative_Path_Traversal__char_connect_socket_fopen_02.cpp",
      "file_name": "CWE23_Relative_Path_Traversal__char_connect_socket_fopen_02.cpp",
      "processed_at": "2025-10-21T08:02:52.113031",
      "token_statistics": {
        "line_entries": 127,
        "token_count": 704
      },
      "tokens_by_line": [
        {
          "line": 17,
          "code": "#include \"std_testcase.h\"",
          "tokens": [
            "#",
            "VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 19,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 20,
          "code": "#define BASEPATH \"c:\\\\temp\\\\\"",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 21,
          "code": "#else",
          "tokens": [
            "#",
            "else"
          ]
        },
        {
          "line": 22,
          "code": "#include <wchar.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 23,
          "code": "#define BASEPATH \"/tmp/\"",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 24,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 26,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 27,
          "code": "#include <winsock2.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 28,
          "code": "#include <windows.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 29,
          "code": "#include <direct.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 30,
          "code": "#pragma comment(lib, \"ws2_32\") ",
          "tokens": [
            "#",
            "VAR",
            "VAR",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")"
          ]
        },
        {
          "line": 31,
          "code": "#define CLOSE_SOCKET closesocket",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "VAR"
          ]
        },
        {
          "line": 32,
          "code": "#else ",
          "tokens": [
            "#",
            "else"
          ]
        },
        {
          "line": 33,
          "code": "#include <sys/types.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 34,
          "code": "#include <sys/socket.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "socket",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 35,
          "code": "#include <netinet/in.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 36,
          "code": "#include <arpa/inet.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            "/",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 37,
          "code": "#include <unistd.h>",
          "tokens": [
            "#",
            "VAR",
            "<",
            "VAR",
            ".",
            "VAR",
            ">"
          ]
        },
        {
          "line": 38,
          "code": "#define INVALID_SOCKET -1",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "-",
            "1"
          ]
        },
        {
          "line": 39,
          "code": "#define SOCKET_ERROR -1",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "-",
            "1"
          ]
        },
        {
          "line": 40,
          "code": "#define CLOSE_SOCKET close",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "VAR"
          ]
        },
        {
          "line": 41,
          "code": "#define SOCKET int",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "int"
          ]
        },
        {
          "line": 42,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 44,
          "code": "#define TCP_PORT 27015",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "NUM_LITERAL"
          ]
        },
        {
          "line": 45,
          "code": "#define IP_ADDRESS \"127.0.0.1\"",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR",
            "\"STRING_LITERAL\""
          ]
        },
        {
          "line": 47,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 48,
          "code": "#define FOPEN fopen",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "fopen"
          ]
        },
        {
          "line": 49,
          "code": "#else",
          "tokens": [
            "#",
            "else"
          ]
        },
        {
          "line": 50,
          "code": "#define FOPEN fopen",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR",
            "fopen"
          ]
        },
        {
          "line": 51,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 53,
          "code": "namespace CWE23_Relative_Path_Traversal__char_connect_socket_fopen_02",
          "tokens": [
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 56,
          "code": "#ifndef OMITBAD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 58,
          "code": "void bad()",
          "tokens": [
            "void",
            "VAR",
            "(",
            ")"
          ]
        },
        {
          "line": 60,
          "code": "    char * data;",
          "tokens": [
            "char",
            "*",
            "VAR",
            ";"
          ]
        },
        {
          "line": 61,
          "code": "    char dataBuffer[FILENAME_MAX] = BASEPATH;",
          "tokens": [
            "char",
            "VAR",
            "[",
            "MACRO_VAR",
            "]",
            "=",
            "TYPE_VAR",
            ";"
          ]
        },
        {
          "line": 62,
          "code": "    data = dataBuffer;",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            ";"
          ]
        },
        {
          "line": 63,
          "code": "    if(1)",
          "tokens": [
            "if",
            "(",
            "1",
            ")"
          ]
        },
        {
          "line": 66,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 67,
          "code": "            WSADATA wsaData;",
          "tokens": [
            "TYPE_VAR",
            "VAR",
            ";"
          ]
        },
        {
          "line": 68,
          "code": "            int wsaDataInit = 0;",
          "tokens": [
            "int",
            "VAR",
            "=",
            "0",
            ";"
          ]
        },
        {
          "line": 69,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 70,
          "code": "            int recvResult;",
          "tokens": [
            "int",
            "VAR",
            ";"
          ]
        },
        {
          "line": 71,
          "code": "            struct sockaddr_in service;",
          "tokens": [
            "struct",
            "VAR",
            "VAR",
            ";"
          ]
        },
        {
          "line": 72,
          "code": "            char *replace;",
          "tokens": [
            "char",
            "*",
            "VAR",
            ";"
          ]
        },
        {
          "line": 73,
          "code": "            SOCKET connectSocket = INVALID_SOCKET;",
          "tokens": [
            "TYPE_VAR",
            "VAR",
            "=",
            "MACRO_VAR",
            ";"
          ]
        },
        {
          "line": 74,
          "code": "            size_t dataLen = strlen(data);",
          "tokens": [
            "VAR",
            "VAR",
            "=",
            "VAR",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 75,
          "code": "            do",
          "tokens": [
            "do"
          ]
        },
        {
          "line": 77,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 78,
          "code": "                if (WSAStartup(MAKEWORD(2,2), &wsaData) != NO_ERROR)",
          "tokens": [
            "if",
            "(",
            "TYPE_VAR",
            "(",
            "TYPE_VAR",
            "(",
            "NUM_LITERAL",
            ",",
            "NUM_LITERAL",
            ")",
            ",",
            "&",
            "VAR",
            ")",
            "!=",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 80,
          "code": "                    break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 82,
          "code": "                wsaDataInit = 1;",
          "tokens": [
            "VAR",
            "=",
            "1",
            ";"
          ]
        },
        {
          "line": 83,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 85,
          "code": "                connectSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);",
          "tokens": [
            "VAR",
            "=",
            "socket",
            "(",
            "MACRO_VAR",
            ",",
            "MACRO_VAR",
            ",",
            "MACRO_VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 86,
          "code": "                if (connectSocket == INVALID_SOCKET)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "==",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 88,
          "code": "                    break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 90,
          "code": "                memset(&service, 0, sizeof(service));",
          "tokens": [
            "memset",
            "(",
            "&",
            "VAR",
            ",",
            "0",
            ",",
            "VAR",
            "(",
            "VAR",
            ")",
            ")",
            ";"
          ]
        },
        {
          "line": 91,
          "code": "                service.sin_family = AF_INET;",
          "tokens": [
            "VAR",
            ".",
            "VAR",
            "=",
            "MACRO_VAR",
            ";"
          ]
        },
        {
          "line": 92,
          "code": "                service.sin_addr.s_addr = inet_addr(IP_ADDRESS);",
          "tokens": [
            "VAR",
            ".",
            "VAR",
            ".",
            "VAR",
            "=",
            "VAR",
            "(",
            "MACRO_VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 93,
          "code": "                service.sin_port = htons(TCP_PORT);",
          "tokens": [
            "VAR",
            ".",
            "VAR",
            "=",
            "VAR",
            "(",
            "MACRO_VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 94,
          "code": "                if (connect(connectSocket, (struct sockaddr*)&service, sizeof(service)) == SOCKET_ERROR)",
          "tokens": [
            "if",
            "(",
            "connect",
            "(",
            "VAR",
            ",",
            "(",
            "struct",
            "VAR",
            "*",
            ")",
            "&",
            "VAR",
            ",",
            "VAR",
            "(",
            "VAR",
            ")",
            ")",
            "==",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 96,
          "code": "                    break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 101,
          "code": "                recvResult = recv(connectSocket, (char *)(data + dataLen), sizeof(char) * (FILENAME_MAX - dataLen - 1), 0);",
          "tokens": [
            "VAR",
            "=",
            "recv",
            "(",
            "VAR",
            ",",
            "(",
            "char",
            "*",
            ")",
            "(",
            "VAR",
            "+",
            "VAR",
            ")",
            ",",
            "VAR",
            "(",
            "char",
            ")",
            "*",
            "(",
            "MACRO_VAR",
            "-",
            "VAR",
            "-",
            "1",
            ")",
            ",",
            "0",
            ")",
            ";"
          ]
        },
        {
          "line": 102,
          "code": "                if (recvResult == SOCKET_ERROR || recvResult == 0)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "==",
            "MACRO_VAR",
            "||",
            "VAR",
            "==",
            "0",
            ")"
          ]
        },
        {
          "line": 104,
          "code": "                    break;",
          "tokens": [
            "break",
            ";"
          ]
        },
        {
          "line": 107,
          "code": "                data[dataLen + recvResult / sizeof(char)] = '\\0';",
          "tokens": [
            "VAR",
            "[",
            "VAR",
            "+",
            "VAR",
            "/",
            "VAR",
            "(",
            "char",
            ")",
            "]",
            "=",
            "'",
            "\\",
            "0",
            "'",
            ";"
          ]
        },
        {
          "line": 109,
          "code": "                replace = strchr(data, '\\r');",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            "(",
            "VAR",
            ",",
            "'",
            "\\",
            "VAR",
            "'",
            ")",
            ";"
          ]
        },
        {
          "line": 110,
          "code": "                if (replace)",
          "tokens": [
            "if",
            "(",
            "VAR",
            ")"
          ]
        },
        {
          "line": 112,
          "code": "                    *replace = '\\0';",
          "tokens": [
            "*",
            "VAR",
            "=",
            "'",
            "\\",
            "0",
            "'",
            ";"
          ]
        },
        {
          "line": 114,
          "code": "                replace = strchr(data, '\\n');",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            "(",
            "VAR",
            ",",
            "'",
            "\\",
            "VAR",
            "'",
            ")",
            ";"
          ]
        },
        {
          "line": 115,
          "code": "                if (replace)",
          "tokens": [
            "if",
            "(",
            "VAR",
            ")"
          ]
        },
        {
          "line": 117,
          "code": "                    *replace = '\\0';",
          "tokens": [
            "*",
            "VAR",
            "=",
            "'",
            "\\",
            "0",
            "'",
            ";"
          ]
        },
        {
          "line": 120,
          "code": "            while (0);",
          "tokens": [
            "while",
            "(",
            "0",
            ")",
            ";"
          ]
        },
        {
          "line": 121,
          "code": "            if (connectSocket != INVALID_SOCKET)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "!=",
            "MACRO_VAR",
            ")"
          ]
        },
        {
          "line": 123,
          "code": "                CLOSE_SOCKET(connectSocket);",
          "tokens": [
            "MACRO_VAR",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 125,
          "code": "#ifdef _WIN32",
          "tokens": [
            "#",
            "VAR",
            "MACRO_VAR"
          ]
        },
        {
          "line": 126,
          "code": "            if (wsaDataInit)",
          "tokens": [
            "if",
            "(",
            "VAR",
            ")"
          ]
        },
        {
          "line": 128,
          "code": "                WSACleanup();",
          "tokens": [
            "TYPE_VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 130,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 134,
          "code": "        FILE *pFile = NULL;",
          "tokens": [
            "TYPE_VAR",
            "*",
            "VAR",
            "=",
            "NULL",
            ";"
          ]
        },
        {
          "line": 136,
          "code": "        pFile = FOPEN(data, \"wb+\");",
          "tokens": [
            "VAR",
            "=",
            "TYPE_VAR",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 137,
          "code": "        if (pFile != NULL)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "!=",
            "NULL",
            ")"
          ]
        },
        {
          "line": 139,
          "code": "            fclose(pFile);",
          "tokens": [
            "fclose",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 144,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 146,
          "code": "#ifndef OMITGOOD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 149,
          "code": "static void goodG2B1()",
          "tokens": [
            "static",
            "void",
            "VAR",
            "(",
            ")"
          ]
        },
        {
          "line": 151,
          "code": "    char * data;",
          "tokens": [
            "char",
            "*",
            "VAR",
            ";"
          ]
        },
        {
          "line": 152,
          "code": "    char dataBuffer[FILENAME_MAX] = BASEPATH;",
          "tokens": [
            "char",
            "VAR",
            "[",
            "MACRO_VAR",
            "]",
            "=",
            "TYPE_VAR",
            ";"
          ]
        },
        {
          "line": 153,
          "code": "    data = dataBuffer;",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            ";"
          ]
        },
        {
          "line": 154,
          "code": "    if(0)",
          "tokens": [
            "if",
            "(",
            "0",
            ")"
          ]
        },
        {
          "line": 157,
          "code": "        printLine(\"Benign, fixed string\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 159,
          "code": "    else",
          "tokens": [
            "else"
          ]
        },
        {
          "line": 162,
          "code": "        strcat(data, \"file.txt\");",
          "tokens": [
            "strcat",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 165,
          "code": "        FILE *pFile = NULL;",
          "tokens": [
            "TYPE_VAR",
            "*",
            "VAR",
            "=",
            "NULL",
            ";"
          ]
        },
        {
          "line": 167,
          "code": "        pFile = FOPEN(data, \"wb+\");",
          "tokens": [
            "VAR",
            "=",
            "TYPE_VAR",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 168,
          "code": "        if (pFile != NULL)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "!=",
            "NULL",
            ")"
          ]
        },
        {
          "line": 170,
          "code": "            fclose(pFile);",
          "tokens": [
            "fclose",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 176,
          "code": "static void goodG2B2()",
          "tokens": [
            "static",
            "void",
            "VAR",
            "(",
            ")"
          ]
        },
        {
          "line": 178,
          "code": "    char * data;",
          "tokens": [
            "char",
            "*",
            "VAR",
            ";"
          ]
        },
        {
          "line": 179,
          "code": "    char dataBuffer[FILENAME_MAX] = BASEPATH;",
          "tokens": [
            "char",
            "VAR",
            "[",
            "MACRO_VAR",
            "]",
            "=",
            "TYPE_VAR",
            ";"
          ]
        },
        {
          "line": 180,
          "code": "    data = dataBuffer;",
          "tokens": [
            "VAR",
            "=",
            "VAR",
            ";"
          ]
        },
        {
          "line": 181,
          "code": "    if(1)",
          "tokens": [
            "if",
            "(",
            "1",
            ")"
          ]
        },
        {
          "line": 184,
          "code": "        strcat(data, \"file.txt\");",
          "tokens": [
            "strcat",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 187,
          "code": "        FILE *pFile = NULL;",
          "tokens": [
            "TYPE_VAR",
            "*",
            "VAR",
            "=",
            "NULL",
            ";"
          ]
        },
        {
          "line": 189,
          "code": "        pFile = FOPEN(data, \"wb+\");",
          "tokens": [
            "VAR",
            "=",
            "TYPE_VAR",
            "(",
            "VAR",
            ",",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 190,
          "code": "        if (pFile != NULL)",
          "tokens": [
            "if",
            "(",
            "VAR",
            "!=",
            "NULL",
            ")"
          ]
        },
        {
          "line": 192,
          "code": "            fclose(pFile);",
          "tokens": [
            "fclose",
            "(",
            "VAR",
            ")",
            ";"
          ]
        },
        {
          "line": 197,
          "code": "void good()",
          "tokens": [
            "void",
            "VAR",
            "(",
            ")"
          ]
        },
        {
          "line": 199,
          "code": "    goodG2B1();",
          "tokens": [
            "VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 200,
          "code": "    goodG2B2();",
          "tokens": [
            "VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 203,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 212,
          "code": "#ifdef INCLUDEMAIN",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 214,
          "code": "using namespace CWE23_Relative_Path_Traversal__char_connect_socket_fopen_02; ",
          "tokens": [
            "VAR",
            "VAR",
            "TYPE_VAR",
            ";"
          ]
        },
        {
          "line": 216,
          "code": "int main(int argc, char * argv[])",
          "tokens": [
            "int",
            "VAR",
            "(",
            "int",
            "VAR",
            ",",
            "char",
            "*",
            "VAR",
            "[",
            "]",
            ")"
          ]
        },
        {
          "line": 219,
          "code": "    srand( (unsigned)time(NULL) );",
          "tokens": [
            "VAR",
            "(",
            "(",
            "VAR",
            ")",
            "VAR",
            "(",
            "NULL",
            ")",
            ")",
            ";"
          ]
        },
        {
          "line": 220,
          "code": "#ifndef OMITGOOD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 221,
          "code": "    printLine(\"Calling good()...\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 222,
          "code": "    good();",
          "tokens": [
            "VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 223,
          "code": "    printLine(\"Finished good()\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 224,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 225,
          "code": "#ifndef OMITBAD",
          "tokens": [
            "#",
            "VAR",
            "TYPE_VAR"
          ]
        },
        {
          "line": 226,
          "code": "    printLine(\"Calling bad()...\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 227,
          "code": "    bad();",
          "tokens": [
            "VAR",
            "(",
            ")",
            ";"
          ]
        },
        {
          "line": 228,
          "code": "    printLine(\"Finished bad()\");",
          "tokens": [
            "VAR",
            "(",
            "\"STRING_LITERAL\"",
            ")",
            ";"
          ]
        },
        {
          "line": 229,
          "code": "#endif ",
          "tokens": [
            "#",
            "VAR"
          ]
        },
        {
          "line": 230,
          "code": "    return 0;",
          "tokens": [
            "return",
            "0",
            ";"
          ]
        },
        {
          "line": 233,
          "code": "#endif",
          "tokens": [
            "#",
            "VAR"
          ]
        }
      ]
    }
  ]
}